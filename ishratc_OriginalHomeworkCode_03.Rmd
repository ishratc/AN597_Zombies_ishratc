---
title: "ishratc_OriginalHomeworkCode_03"
author: "Ishrat Chowdhury"
date: "October 3, 2019"
output: html_document
---

First let's load our data into R

```{r}
library(curl)
f <- curl("https://raw.githubusercontent.com/fuzzyatelin/fuzzyatelin.github.io/master/AN597_Fall19/zombies.csv")
d <- read.csv(f, header = TRUE, sep = ",", stringsAsFactors = FALSE)
head(d)
```

1. Calculate the population mean and standard deviation for each quantitative random variable.

```{r}
height<-d$height
hm<-mean(height)
hm
hsd<-sd(height)
hsd

weight<-d$weight
wm<-mean(weight)
wm
wsd<-sd(weight)
wsd

age<-d$age
am<-mean(age)
am
asd<-sd(age)
asd

zombies_killed<-d$zombies_killed
zm<-mean(zombies_killed)
zm
zsd<-sd(zombies_killed)
zsd

yrs_edu<-d$years_of_education
ym<-mean(yrs_edu)
ym
ysd<-sd(yrs_edu)
ysd

```
2. Use {ggplot} to make boxplots of each of these variables by gender. I guess this can be used for comparison.

```{r}
mh<- d$height[d$gender == "Male"]
fh<- d$height[d$gender == "Female"]
mw<- d$weight[d$gender == "Male"]
fw<- d$weight[d$gender == "Female"]
ma<- d$age[d$gender == "Male"]
fa<- d$age[d$gender == "Female"]
mz<- d$zombies_killed[d$gender == "Male"]
fz<- d$zombies_killed[d$gender == "Female"]
my<- yrs_edu[d$gender == "Male"]
fy<- yrs_edu[d$gender == "Female"]
par(mfrow =c(1,2))
boxplot(mh, main = "Height", xlab = "Males", ylab = "inches")
boxplot(fh, main = "Height", xlab = "Females", ylab = "inches")
boxplot(mw, main = "Weight", xlab = "Males", ylab = "pounds")
boxplot(fw, main = "Weight", xlab = "Females", ylab = "pounds")
boxplot(ma, main = "Age", xlab = "Males", ylab = "years")
boxplot(fa, main = "Age", xlab = "Females", ylab = "years")
boxplot(mz, main = "# of Zombies Killed", xlab = "Males")
boxplot(fz, main = "# of Zombies Killed", xlab = "Females")
boxplot(my, main = "Years of Education", xlab = "Males", ylab = "years")
boxplot(fy, main = "Years of Education", xlab = "Females", ylab = "years")
```

Now to answer the question correctly
```{r}
library(ggplot2)
library(readr)
d1_url<-"https://raw.githubusercontent.com/fuzzyatelin/fuzzyatelin.github.io/master/AN597_Fall19/zombies.csv"
d1<-read_csv(d1_url)
head(d1)
```
```{r}
h <- ggplot(d1) +
      geom_boxplot(aes(x=gender, y=height))
h
```

```{r}
w <- ggplot(d1) +
      geom_boxplot(aes(x=gender, y=weight))
w
```

```{r}
a <- ggplot(d1) +
      geom_boxplot(aes(x=gender, y=age))
a
```

```{r}
z <- ggplot(d1) +
      geom_boxplot(aes(x=gender, y=zombies_killed))
z
```

```{r}
y <- ggplot(d1) +
      geom_boxplot(aes(x=gender, y=years_of_education))
y
```

3. Use {ggplot} to make scatterplots of height and weight in relation to age. Are these variables related? Why?

```{r}
hw<- ggplot(d1) + 
      geom_point(aes(x=weight, y=height))
hw
```
q-q plots

```{r}
hist(height)
qqnorm(height)
```

```{r}
hist(weight)
qqnorm(weight)
```

```{r}
hist(age)
qqnorm(age)
```

```{r}
hist(zombies_killed)
qqnorm(zombies_killed)
```


3. Use {ggplot} to make scatterplots of height and weight in relation to age. Are these variables related? Why?

```{r}
hist(yrs_edu)
qqnorm(yrs_edu)
```

fix ones that are not normally distributed (zombies killed and yrs of edu) both appear to be right skewed

actually.. these are probs poisson bc they are integers and idnependantly related 

```{r}
?dpois # dpois gives log density and ppois gives log distribution
zd<-dpois(0:12, lambda = zm)
barplot(zd)
#looks better but there is an outlier (afraid to remove points) also can I transform them 

```

```{r}
yd<-dpois(yrs_edu, lambda = ym)
yd
hist(yd)

yd<-dpois(x=0:10, lambda = ym)
barplot(yd)

#not sur eif either of these make sense
```

the following is just me exploring

found this package that gives a skewness coefficient haha kind of cool not sure if it means anything though

```{r}
install.packages("e1071") 
library(e1071)
sz<-skewness(zombies_killed)
sz
sy<-skewness(yrs_edu)
sy

```

positively skewed data


```{r}
install.packages("outliers")
library(outliers)
outlier(zombies_killed)
```

use sample funcion to sample one subset of 30 zombie suruvivers without replacement, from pop

calc mean and sd for each variable
se for each and 95% ci for each mean
different code for z and y

```{r}

?sample
nd<-d[sample(nrow(d), 30),]
nd
```

mean and standard deviations of sample

```{r}
nheight<-nd$height
nhm<-mean(nheight)
nhm
nhsd<-sd(nheight)
nhsd

nweight<-nd$weight
nwm<-mean(nweight)
nwm
nwsd<-sd(nweight)
nwsd

nage<-nd$age
nam<-mean(nage)
nam
nasd<-sd(nage)
nasd

nzombies_killed<-nd$zombies_killed
nzm<-mean(nzombies_killed)
nzm
nzsd<-sd(nzombies_killed)
nzsd

nyrs_edu<-nd$years_of_education
nym<-mean(nyrs_edu)
nym
nysd<-sd(nyrs_edu)
nysd
```

standard errors and 95% ci

```{r}
hse<-sqrt(nhsd^2/30)
hse

wse<-sqrt(nwsd^2/30)
wse

ase<-sqrt(nasd^2/30)
ase

zse<-sqrt(nzsd^2/30)
zse

yse<-sqrt(nysd^2/30)
yse
```

these are all sample size 30 so t distrubution needs to be used 

```{r}
lower <- nhm - qt(1 - 0.05/2, df = 29) * hse  # (1-alpha)/2 each in the upper and lower tails of the distribution
upper <- nhm + qt(1 - 0.05/2, df = 29) * hse  # (1-alpha)/2 each in the upper and lower tails of the distribution
nhci_t <- c(lower, upper)
nhci_t

lower <- nwm - qt(1 - 0.05/2, df = 29) * wse  # (1-alpha)/2 each in the upper and lower tails of the distribution
upper <- nwm + qt(1 - 0.05/2, df = 29) * wse  # (1-alpha)/2 each in the upper and lower tails of the distribution
nwci_t <- c(lower, upper)
nwci_t

lower <- nam - qt(1 - 0.05/2, df = 29) * ase  # (1-alpha)/2 each in the upper and lower tails of the distribution
upper <- nam + qt(1 - 0.05/2, df = 29) * ase  # (1-alpha)/2 each in the upper and lower tails of the distribution
naci_t <- c(lower, upper)
naci_t


#doesn't lambda equal mean so shouldn't it be the same???

lower <- nzm - qt(1 - 0.05/2, df = 29) * zse  # (1-alpha)/2 each in the upper and lower tails of the distribution
upper <- nzm + qt(1 - 0.05/2, df = 29) * zse  # (1-alpha)/2 each in the upper and lower tails of the distribution
zwci_t <- c(lower, upper)
zwci_t

lower <- nym - qt(1 - 0.05/2, df = 29) * yse  # (1-alpha)/2 each in the upper and lower tails of the distribution
upper <- nym + qt(1 - 0.05/2, df = 29) * yse  # (1-alpha)/2 each in the upper and lower tails of the distribution
yaci_t <- c(lower, upper)
yaci_t

```

that definately needs to be revised and better annotated but 5/6 done so far

6. draw 99 samples of 30 


```{r}
s <- NULL # dummy variable to hold each sample
for (i in 1:99){
    s[[i]] <- sample(d, size = 30, replace=FALSE)
}
head(s) #that worked but it looks odd
```

calc mean now with first have 100 means for each variable = smapling dist

```{r}
sample(d, 30, repla)

```


means and sd of means 

compare to se

what do sampling distributions look like, graph

normal?